<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Fontenay</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- MetisMenu CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/metisMenu/2.7.9/metisMenu.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <div id="wrapper">
        <div id="page-wrapper" class="printPage">
            <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    <h1 class="page-header">FONTENAY TOURS</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 ">
                    <p>
                        Av. Córdoba 543, local 74.<br>
                        CP 1054, CABA.<br>
                        Ciudad Autónoma de Buenos Aires, Argentina.
                    </p>
                    <p>
                       Número de identificación fiscal:
                    </p>
                    <p>
                        Teléfono: +54 11 68388892<br>
                        Lunes a Viernes, de 9:00hs. a 18:00hs.<br>
                        fontenaytours@gmail.com<br>
                        www.fontenaytours.com<br>
                    </p>
                </div>

                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 ">
                    <p>
                        N° de formato: 123456789<br>
                        Fecha del formato: 01/Ene/2018<br>
                    </p>
                    <div class="form-group col-md-3">
                        <label>Total</label>
                        <p class="productTotal form-control-static"></p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="table-responsive col-xs-12 col-sm-12 col-md-12 col-lg-12 ">
                    <table class="table table-striped" id="itemsTable">
                        <thead>
                            <tr>
                                <th>Descripción</th>
                                <th>Cantidad</th>
                                <th>Precio unitario</th>
                                <th>Importe</th>
                            </tr>
                        </thead>
                        <tbody class="itemsTableBody"></tbody></table>
                </div>
                <div class="table-responsive col-xs-12 col-sm-12 col-md-12 col-lg-12 ">
                    <table class="table table-striped" id="paymentsTable">
                        <thead>
                        <tr>
                            <th>Método de pago</th>
                            <th>Moneda</th>
                            <th>Importe</th>
                        </tr>
                        </thead>
                        <tbody class="paymentsTableBody"></tbody></table>
                </div>
            </div>
        </div>
    </div>
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- Metis Menu Plugin JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/metisMenu/2.7.9/metisMenu.min.js"></script>
    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/fontenay.js"></script>

    <script>
        $(document).ready(function() {
            var myParam = location.search.split("saleid=")[1];
            console.log(myParam);
            _loadSale(myParam);
        });

        function _loadSale(id) {
            var salePromise = new Promise(
                function (resolve, reject) {
                    _getSale(resolve, reject, id);
                }
            );

            var load = function() {
                salePromise
                    .then(function (result) {
                        _fillInformation(result);
                    })
                    .catch(function (error) {
                        console.log(error.message);
                    });
            };
            load();
        }

        function  _fillInformation(sale) {
            $(".productTotal").text("$ "+sale.total + ".00");
            sale.products.forEach(function(el){
                loadItemTableRow(el);
            });
            sale.payments.forEach(function(el){
                loadPaymentTableRow(el);
            });
        }

        function loadItemTableRow(product) {
            var td1 = $(document.createElement("td")).text(product.product.name);
            var td2 = $(document.createElement("td")).text(product.adults + product.children + product.babies);
            var td3 = $(document.createElement("td")).text(product.product.selling_price);
            var td4 = $(document.createElement("td")).text(product.price);
            var tr1 = $(document.createElement("tr")).append(td1).append(td2).append(td3).append(td4);
            $(".itemsTableBody").append(tr1);
        }

        function loadPaymentTableRow(payment) {
            var td1 = $(document.createElement("td")).text(payment.product.name);
            var td2 = $(document.createElement("td")).text(payment);
            var td3 = $(document.createElement("td")).text(payment);
            var tr1 = $(document.createElement("tr")).append(td1).append(td2).append(td3);
            $(".paymentsTableBody").append(tr1);
        }
    </script>
</body>

</html>
