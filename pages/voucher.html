<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Fontenay</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- MetisMenu CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/metisMenu/2.7.9/metisMenu.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <div id="wrapper" style="max-width: 1100px">
        <div id="page-wrapper" class="printPage">
            <div class="row voucherHeader">
                <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4" style="height: 80px;">
                    <img src="../dist/images/logo.png" style="width: 100%;margin: 10px 0 0 0;max-height: 70px;">
                </div>
                <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 voucherHeaderDetails">
                    <div>Número de solicitud de compra:</div>
                    <div><strong>325853086800</strong></div>
                    <div>Email:</div>
                    <div><strong>fontenaytours@gmail.com</strong></div>
                </div>
                <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                    <div>Código de reserva / Reservation number:</div>
                    <h3><strong class="voucher-id">N°-</strong></h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                    <div class="form-group lessSpace">
                        <label>Pasajeros/Pax:</label>
                        <p class="clientnamelabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Pasaporte/ID/Passport:</label>
                        <p class="passportlabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Hotel:</label>
                        <p class="hotellabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Dirección:</label>
                        <p class="addresslabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Email:</label>
                        <p class="emaillabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Servicio:</label>
                        <p class="productlabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Proveedor:</label>
                        <p class="providerlabel form-control-static inlineBlock"></p>
                    </div>
                </div>
                <div class="col-xs-5 col-sm-5 col-md-5 col-lg-5">
                    <div class="form-group lessSpace">
                        <label>Habitación:</label>
                        <p class="roomlabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Adultos/Adults:</label>
                        <p class="adultslabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Niños/Children:</label>
                        <p class="childrenlabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Bebés/Babies:</label>
                        <p class="babieslabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Pick-up:</label>
                        <p class="transferlabel form-control-static inlineBlock"></p>
                    </div>
                    <div class="form-group lessSpace">
                        <label>Fecha/Date:</label>
                        <p class="datelabel form-control-static inlineBlock"></p>
                    </div>
                </div>
            </div>
            <div class="row">
                <h3 class="voucherBarTitle">Instrucciones y datos de contacto</h3>
            </div>
            <div class="row">
                <p class="voucherText">
                    En caso de emergencia, comunicarse con Fontenay Tours<br>
                    Mail: <a>fontenaytours@gmail.com</a><br>
                    Teléfono: +54 11 4893 0771 / +54 11 68388892 (WhatsApp)
                </p>
            </div>
            <div class="row">
                <p class="voucherText">
                    Dada la Ley Civil de Argentina, Fontenay no es responsable de los sucesos provocados por terceros, fuerza mayor y eventos de la naturaleza.
                </p>
            </div>
            <div class="row">
                <p class="voucherText">
                    No se responsabiliza de viaje opcional vendido en cada lugar. Ninguno de nuestros guías y/o controladores están autorizados a revender estos opcionales. Las guías y los conductores son capaces de simplemente orientar e informar a los clientes sobre las atracciones locales (ejemplos: paseos, restaurantes y otros). Para su seguridad, si usted quiere comprar un tour o una transferencia, haga contacto directo con el centro de Fontenay Tours.
                </p>
            </div>
            <div class="row">
                <p class="voucherText">
                    Las pertenencias de mano transportados en el vehículo son responsabilidad del pasajero y no están sujetos a ningún tipo de indemnización por daños o pérdidas. (De acuerdo con la Resolución 1432, párrafo 6, el artículo 8 26/04/2006 ANTT).
                </p>
            </div>
            <div class="row">
                <h5><strong>Datos de contacto</strong></h5>
                <p class="voucherText">
                    Teléfonos:  +54 11 4893 0771 / +54 11 6838 8892<br>
                    Correo electrónico: fontenaytours@gmail.com<br>
                    Dirección: Av. Cordoba 543, Galeria Buenos Aires, Escritorio “74”
                </p>
            </div>
            <div class="row">
                <h4><strong>Políticas de cancelación</strong></h4>
                <p class="voucherText">
                    Si cancelás a partir del 03/07/2019 a las 00:00 (fecha y hora del destino donde inicia la actividad), no podés solicitar reembolso. La reserva no permite cambios.
                </p>
            </div>
            <div class="row voucherFooter">
                <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1"><i class="printIconVoucher fa fa-print"></i></div>
                <div class="col-xs-5 col-sm-5 col-md-5 col-lg-5" style="padding-top: 27px;"><strong>Imprima este voucher.</strong></div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6" style="padding-top: 27px; text-align: right;">Imprima este voucher y llévelo con usted en su viaje.</div>
            </div>
        </div>
    </div>
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- Metis Menu Plugin JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/metisMenu/2.7.9/metisMenu.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/fontenay.js"></script>

    <script>
        $(document).ready(function() {
            var myParam = location.search.split("saleid=")[1].split("&")[0];
            _loadSale(myParam);
        });

        function _loadSale(id) {
            var salePromise = new Promise(
                function (resolve, reject) {
                    _getSale(resolve, reject, id);
                }
            );

            var load = function(salePromise) {
                salePromise
                    .then(function (result) {
                        _fillInformation(result);
                    })
                    .catch(function (error) {
                        console.log(error.message);
                    });
            };
            load(salePromise);
        }

        function  _fillInformation(sale) {
            var numberOfVouchers = sale.products.length;
            if(1 === numberOfVouchers) {
                _fillProductData(sale.products[0], $(".printPage"));
            } else {
                for(var i = 0; i < numberOfVouchers ; i++) {
                    var el = sale.products[i];
                    var voucherIDClass = "voucher-" + el.sold_product_id;
                    var previousVoucherIDClass = "voucher-" + (el.sold_product_id - 1);
                    var newVoucher;
                    if(i === 0) {
                        newVoucher  = $(".printPage").addClass(voucherIDClass);
                    } else {
                        newVoucher = $("."+previousVoucherIDClass).clone().addClass(voucherIDClass).removeClass(previousVoucherIDClass);
                    }
                    $("#wrapper").append(newVoucher);
                    _fillProductData(el, $("." + voucherIDClass));
                }
            }
            _fillClient(sale.client);


            var myParams = location.search.split("download=");
            if(myParams[1] !== undefined && myParams[1] === "true") {
                _downloadPDF(sale.sale_id)
            }
        }

        function  _fillClient(client) {
            $(".clientnamelabel").text(client.name);
            $(".passportlabel").text(client.passport_number);
            $(".nationalitylabel").text(client.nationality);
            $(".hotellabel").text(client.hotel);
            $(".addresslabel").text(client.address);
            $(".roomlabel").text(client.room_number);
            $(".phonelabel").text(client.contact_number);
            $(".emaillabel").text(client.email);
        }

        function _fillProductData(prod, container) {
            var prodDate = _getFormatDateDDMMYYYYHHMM(prod.date);
            var transferLabel = prod.transfer? "SÍ  (" + prodDate.split(" ")[1] + " hs.)" : "NO";
            container.find(".voucher-id").text("N°- F000000" + prod.sold_product_id);
            container.find(".productlabel").text(prod.product.name);
            container.find(".providerlabel").text(prod.product.provider.name);
            container.find(".adultslabel").text(prod.adults);
            container.find(".childrenlabel").text(prod.children);
            container.find(".babieslabel").text(prod.babies);
            container.find(".transferlabel").text(transferLabel);
            container.find(".datelabel").text(prodDate.split(" ")[0]);
        }


        function _downloadPDF(saleid) {
            var w = 1100;
            $("#wrapper").width(w);
            var h = document.getElementById("wrapper").offsetHeight;
            html2canvas(document.getElementById("wrapper"), {
                dpi: 300, // Set to 300 DPI
                scale: 3, // Adjusts your resolution
                onrendered: function (canvas) {
                    var img = canvas.toDataURL("image/jpeg", 1);
                    var doc = new jsPDF('P', 'px', [h, 850]);
                    doc.addImage(img, 'JPEG', 0, 0);
                    doc.save('VOUCHERS-VENTA-N-' + saleid + '.pdf');
                }
            });
        }
    </script>
</body>

</html>
